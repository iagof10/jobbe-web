@model long

@{
    ViewData["Title"] = "Home Page";
}

@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="pt-br" data-footer="true" data-override='{"attributes":{"layout": "boxed"}}'>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <title>Jobbe</title>
    <meta name="description" content="Portfolio Home Page" />
    <!-- Favicon Tags Start -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../img/logo/icon_sol.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../img/logo/icon_sol.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../img/logo/icon_sol.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../img/logo/icon_sol.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../img/logo/icon_sol.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../img/logo/icon_sol.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../img/logo/icon_sol.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../img/logo/icon_sol.png" />
    <link rel="icon" type="image/png" href="../img/logo/icon_sol.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../img/logo/icon_sol.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../img/logo/icon_sol.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../img/logo/icon_sol.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../img/logo/icon_sol.png" sizes="128x128" />
    <meta name="application-name" content="&nbsp;" />
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../img/logo/icon_sol.png" />
    <meta name="msapplication-square70x70logo" content="../img/logo/icon_sol.png" />
    <meta name="msapplication-square150x150logo" content="../img/logo/icon_sol.png" />
    <meta name="msapplication-wide310x150logo" content="../img/logo/icon_sol.png" />
    <meta name="msapplication-square310x310logo" content="../img/logo/icon_sol.png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
    <script src="https://unpkg.com/sweetalert2@7.8.2/dist/sweetalert2.all.js"></script>
    <!-- Favicon Tags End -->
    <!-- Font Tags Start -->
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../font/CS-Interface/style.css" />
    <!-- Font Tags End -->
    <!-- Vendor Styles Start -->
    <link rel="stylesheet" href="../css/vendor/bootstrap.min.css" />
    <link rel="stylesheet" href="../css/vendor/OverlayScrollbars.min.css" />

    <link rel="stylesheet" href="../css/vendor/baguetteBox.min.css" />

    <!-- Vendor Styles End -->
    <!-- Template Base Styles Start -->
    <link rel="stylesheet" href="../css/styles.css" />
    <!-- Template Base Styles End -->

    <link rel="stylesheet" href="../css/main.css" />
    <script src="../js/base/loader.js"></script>
    <script src="../js/site.js"></script>

</head>

<body>
    <div id="root">
        <main style="padding-top: 5vh;">
            <div class="container">
                <div class="row gx-4 gy-5">
                    <!-- Left Side Start -->
                    <div class="col-12 col-xl-4 col-xxl-3">
                        <!-- Biography Start -->
                        <div class="card">
                            <div class="card-body mb-n5">
                                <div class="d-flex align-items-center flex-column">
                                    <div class="mb-3 d-flex align-items-center flex-column">
                                        <div class="sw-13 position-relative mb-3">
                                            <img id="fotoPerfilPrestador" src="../img/profile/profile-2.webp" class="img-fluid card" alt="thumb" />
                                        </div>
                                        <div class="h5 mb-0"><span id="apelidoPrestador"></span></div>
                                        <div class="text-muted"><span id="categoriaPrestador"></span></div>
                                        <div class="text-muted">
                                            <i data-cs-icon="email" class="me-1"></i>
                                            <span class="align-middle"><span id="emailPrestador"></span></span>
                                        </div>
                                        <div class="mb-3" id="listaTelefone">
                                        </div>

                                        <div>
                                            <img src="../img/favicon/olho.png" style="width: 3.5vh">
                                        </div>

                                        <div>
                                            <span id="numVisualizacoes" style="color: #bfbfbf"></span>
                                        </div>

                                    </div>
                                </div>


                                <div class="d-flex align-items-center flex-column mb-5">
                                    <a id="callWhatsapp" class="btn btn-outline-primary w-100 me-2">Chamar no WhatsApp</a>
                                </div>

                                <div class="d-flex align-items-center flex-column mb-5">
                                    <a id="callPhoneNumber" class="btn btn-outline-primary w-100 me-2">Ligar</a>
                                </div>

                                <div class="mb-5">

                                    <p id="tituloMuralPrestador" class="text-medium text-muted mb-2">

                                    </p>
                                    <p id="descMuralPrestador">

                                    </p>
                                </div>

                                <div class="mb-5">
                                    <p class="text-medium text-muted mb-1">
                                        Região de Atendimento
                                    </p>
                                    <p id="txtRegiaoAtendimento" class="mb-1">
                                        
                                    </p>

                                    <p id="txtRegiaoAtendimentoCidade" class="mb-2">
                                        
                                    </p>

                                    <p class="text-medium text-muted mb-1">
                                        Atende em um raio de:
                                    </p>
                                    <p id="txtRaioAtendimento" class="mb-2">
                                        
                                    </p>
                                </div>

                                <div class="mb-2">
                                    <p class="text-medium text-muted mb-2">Compartilhe este perfil com sua rede!</p>
                                </div>

                                <div class="d-flex mb-5">

                                    <a href="http://google.com" style="margin-right: 2vw">
                                        <img src="../img/favicon/whatsapp.png" style="width: 5vh">
                                    </a>

                                    <a href="http://google.com" style="margin-right: 2vw">
                                        <img src="../img/favicon/instagram2.png" style="width: 5vh">
                                    </a>

                                    <a href="http://google.com" style="margin-right: 2vw">
                                        <img src="../img/favicon/facebook.png" style="width: 5vh">
                                    </a>

                                    <a href="http://google.com" style="margin-right: 2vw">
                                        <img src="../img/favicon/email.png" style="width: 5vh">
                                    </a>

                                </div>

                            </div>
                        </div>

                        <br />

                        <div id="listaCards">
                        </div>

                        <!-- Biography End -->
                    </div>
                    <!-- Left Side End -->
                    <!-- Right Side Start -->
                    <div class="col-12 col-xl-8 col-xxl-9">
                        <!-- Title Tabs Start -->
                        <ul class="nav nav-tabs nav-tabs-title nav-tabs-line-title responsive-tabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <a class="nav-link active" data-bs-toggle="tab" href="#projectsTab" role="tab" aria-selected="true">Galeria</a>
                            </li>
                            <li class="nav-item" role="presentation">
                                <a class="nav-link" data-bs-toggle="tab" href="#publicacaoTab" role="tab" aria-selected="false">Publicações</a>
                            </li>
                        </ul>
                        <!-- Title Tabs End -->

                        <div class="tab-content">
                            <!-- Projects Tab Start -->
                            <div class="tab-pane fade active show" id="projectsTab" role="tabpanel">

                                <br />

                                <div class="d-flex align-items-center flex-column mb-5">
                                    <button type="button" class="btn btn-outline-primary w-100 me-2" data-bs-toggle="modal" data-bs-target="#modalAddGaleria">Add Mídia</button>
                                </div>

                                <div class="modal fade" id="exampleModalFullscreen" tabindex="-1" aria-labelledby="exampleModalFullscreenLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-fullscreen">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <div class="sw-7 me-1 mb-1 d-inline-block">
                                                    <img id="fotoPerfilGaleriaAmpliada" class="img-fluid rounded-md" alt="thumb" />
                                                </div>
                                                <h5 class="modal-title h4" id="nomeUsuarioGaleriaAmpliada"></h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div id="frameImagemAmpliada" class="modal-body" style="padding-left: 0;padding-right: 0;">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- List Start -->
                                <div class="row row-cols-1 row-cols-sm-2 row-cols-xxl-3 g-2 mb-5" id="listaGaleria">
                                </div>
                                <!-- List End -->

                            </div>
                            <!-- Projects Tab End -->
                            <!-- Collections Tab Start -->
                            <div class="tab-pane fade" id="publicacaoTab" role="tabpanel">

                                <br />

                                <div class="modal fade" id="modalPublicacaoAmpliada" tabindex="-1" aria-labelledby="exampleModalFullscreenLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-fullscreen">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <div class="sw-7 me-1 mb-1 d-inline-block">
                                                    <img id="fotoPublicacaoAmpliada" class="img-fluid rounded-md" alt="thumb" />
                                                </div>
                                                <h5 class="modal-title h4" id="nomeUsuarioPublicacaoAmpliada"></h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div id="framePublicacaoAmpliada" class="modal-body" style="padding-left: 0;padding-right: 0;">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- List Start -->
                                <div class="mb-5" id="listaPublicacao">
                                </div>
                                <!-- List End -->
                            </div>
                            <!-- Collections Tab End -->
                        </div>
                    </div>
                    <!-- Right Side End -->
                </div>
            </div>
        </main>
    </div>

    <!-- Theme Settings Modal Start -->
    <div class="modal fade modal-right scroll-out-negative"
         id="settings"
         data-bs-backdrop="true"
         tabindex="-1"
         role="dialog"
         aria-labelledby="settings"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable full" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Selecione sua preferência</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                    <div class="scroll-track-visible">
                        <div class="mb-5" id="color">
                            <label class="mb-3 d-inline-block form-label">Tema</label>

                            <div class="row d-flex g-3 justify-content-between flex-wrap mb-3">
                                <a href="#" class="flex-grow-1 w-50 option col" data-value="light-red" data-parent="color">
                                    <div class="card rounded-md p-3 mb-1 no-shadow color">
                                        <div class="red-light"></div>
                                    </div>
                                    <div class="text-muted text-part">
                                        <span class="text-extra-small align-middle">Tema Claro</span>
                                    </div>
                                </a>
                                <a href="#" class="flex-grow-1 w-50 option col" data-value="dark-red" data-parent="color">
                                    <div class="card rounded-md p-3 mb-1 no-shadow color">
                                        <div class="red-dark"></div>
                                    </div>
                                    <div class="text-muted text-part">
                                        <span class="text-extra-small align-middle">Tema Escuro</span>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Theme Settings Modal End -->
    <!-- Theme Settings & Niches Buttons Start -->
    <div class="settings-buttons-container">
        <button type="button" class="btn settings-button btn-primary p-0" data-bs-toggle="modal" data-bs-target="#settings" id="settingsButton">
            <span class="d-inline-block no-delay" data-bs-delay="0" data-bs-offset="0,3" data-bs-toggle="tooltip" data-bs-placement="left" title="Settings">
                <i data-cs-icon="paint-roller" class="position-relative"></i>
            </span>
        </button>
    </div>
    <!-- Theme Settings & Niches Buttons End -->
    <!-- Search Modal Start -->
    <div class="modal fade modal-under-nav modal-search modal-close-out" id="searchPagesModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header border-0 p-0">
                    <button type="button" class="btn-close btn btn-icon btn-icon-only btn-foreground" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body ps-5 pe-5 pb-0 border-0">
                    <input id="searchPagesInput" class="form-control form-control-xl borderless ps-0 pe-0 mb-1 auto-complete" type="text" autocomplete="off" />
                </div>
                <div class="modal-footer border-top justify-content-start ps-5 pe-5 pb-3 pt-3 border-0">
                    <span class="text-alternate d-inline-block m-0 me-3">
                        <i data-cs-icon="arrow-bottom" data-cs-size="15" class="text-alternate align-middle me-1"></i>
                        <span class="align-middle text-medium">Navigate</span>
                    </span>
                    <span class="text-alternate d-inline-block m-0 me-3">
                        <i data-cs-icon="arrow-bottom-left" data-cs-size="15" class="text-alternate align-middle me-1"></i>
                        <span class="align-middle text-medium">Select</span>
                    </span>
                </div>
            </div>
        </div>
    </div>
    <!-- Search Modal End -->
    <!-- Vendor Scripts Start -->
    <script src="../js/vendor/jquery-3.5.1.min.js"></script>
    <script src="../js/vendor/bootstrap.bundle.min.js"></script>
    <script src="../js/vendor/OverlayScrollbars.min.js"></script>
    <script src="../js/vendor/autoComplete.min.js"></script>
    <script src="../js/vendor/clamp.min.js"></script>
    <script src="../js/vendor/baguetteBox.min.js"></script>
    <script src="../js/cs/responsivetab.js"></script>
    <!-- Vendor Scripts End -->
    <!-- Template Base Scripts Start -->
    <script src="../font/CS-Line/csicons.min.js"></script>
    <script src="../js/base/helpers.js"></script>
    <script src="../js/base/globals.js"></script>
    <script src="../js/base/nav.js"></script>
    <script src="../js/base/search.js"></script>
    <script src="../js/base/settings.js"></script>
    <script src="../js/base/init.js"></script>
    <!-- Template Base Scripts End -->
    <!-- Page Specific Scripts Start -->
    <script src="../js/pages/portfolio.home.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/scripts.js"></script>
    <!-- Page Specific Scripts End -->

    <script>


        GetPerfilPrestador()
        GetPublicacaoPrestador()
        GetGaleriaPrestador()

        var existMuralPrestador = false
        var idMuralPrestador = 0
        var idCardDelete = 0

        function GetPerfilPrestador() {
            const ajax = new XMLHttpRequest();
            ajax.open('GET', RotaAPI + 'api/UsuarioPrestador?idUsuario=' + @Model);
            ajax.responseType = 'json';
            ajax.onload = function (e) {
                if (this.status == 200) {
                    document.getElementById("apelidoPrestador").textContent = this.response.data.apelido;
                    document.getElementById("categoriaPrestador").textContent = this.response.data.categoria.descricao;
                    document.getElementById("emailPrestador").textContent = this.response.data.email;
                    document.getElementById("numVisualizacoes").textContent = this.response.data.numVisualizacoes;

                    if(this.response.data.raio != 0){
                        document.getElementById("txtRaioAtendimento").innerText = this.response.data.raio + " Kilômetros";
                    }

                    if(this.response.data.enderecoBase != null){
                        document.getElementById("txtRegiaoAtendimento").innerText = this.response.data.enderecoBase.bairro;
                        document.getElementById("txtRegiaoAtendimentoCidade").innerText = this.response.data.enderecoBase.localidadeNome + " - " + this.response.data.enderecoBase.uf;
                    }

                    console.log(this.response)

                    if (this.response.data.mural != null) {
                        idMuralPrestador = this.response.data.mural.id
                        existMuralPrestador = true
                        document.getElementById("descMuralPrestador").textContent = this.response.data.mural.descricao;
                        document.getElementById("tituloMuralPrestador").textContent = this.response.data.mural.titulo;
                        descricao = this.response.data.mural.descricao;
                        titulo = this.response.data.mural.titulo;
                        document.getElementById('fotoPerfilPrestador').src = RotaAPI + "api/UsuarioPrestador/" + this.response.data.idFotoPerfil
                    }

                    if (this.response.data.cards != null) {

                        for (let i = 0; i < this.response.data.cards.length; i = i + 1) {

                            var html = `
                                <div style="padding-left: 2vw;padding-right: 2vw;padding-top: 13px;padding-bottom: 13px;margin-bottom: 10px;" class="card">
                                  <div class="row g-0 align-items-center">
                                            <div class="col-auto">
                                                <div class="border border-primary sw-5 sh-5 rounded-xl d-flex justify-content-center align-items-center">
                                                    <i data-cs-icon="clipboard" class="text-primary"></i>
                                                </div>
                                            </div>
                                            <div class="col ps-3">
                                                <div class="row g-0">
                                                    <div class="col">
                                                        <h5>` + this.response.data.cards[i].titulo + `</h5>
                                                        <p class="text-muted m-0 text-small">` + this.response.data.cards[i].descricao + `</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-auto">
                                                <button data-bs-toggle="modal" data-bs-target="#modalDeleteCard" id="` + this.response.data.cards[i].id + `" onclick="selectCardDelete(this.id)" class="btn btn-sm btn-icon btn-icon-only btn-outline-primary ms-1" type="button">
                                                    <i data-cs-icon="close"></i>
                                                </button>
                                            </div>
                                        </div>
                                </div>
                                `;

                            document.getElementById("listaCards").innerHTML += html
                        }

                        csicons.replace()

                    }

                    if (this.response.data.telefones != null) {

                       var whatsAppLink = document.getElementById('callWhatsapp');
                       var phoneNumberLink = document.getElementById('callPhoneNumber');

                        whatsAppLink.href = 'https://api.whatsapp.com/send?phone=55' + this.response.data.telefones[0].numeroTelefone + '&text=Olá, preciso de um serviço!'
                        whatsAppLink.target = '_blank'

                        phoneNumberLink.href = 'tel://+55' + this.response.data.telefones[0].numeroTelefone

                        for (let i = 0; i < this.response.data.telefones.length; i = i + 1) {
                            var html = `
                              <div class="text-muted">
                                        <i data-cs-icon="phone" class="me-1"></i>
                                        <span class="align-middle"><span></span>` + this.response.data.telefones[i].numeroTelefone + `</span>
                                </div>
                            `;

                            document.getElementById("listaTelefone").innerHTML += html
                        }

                    }
                }
            };

            ajax.send();
        }

        function GetPublicacaoPrestador() {
            const ajax = new XMLHttpRequest();
            ajax.open('GET', RotaAPI + 'api/Publicacao?idUsuario=' + @Model);
            ajax.responseType = 'json';
            ajax.onload = function (e) {
                if (this.status == 200) {

                    console.log(this.response)

                    if (this.response.data != null) {

                        for (let i = 0; i < this.response.data.length; i = i + 1) {
                            var html = `
                                            <div id="publicacao` + this.response.data[i].id + `" data-bs-toggle="modal" data-bs-target="#modalPublicacaoAmpliada" class="card mb-5">
                                                    <a>
                                                        <img style="min-height: 70vh;" src="` + RotaAPI + 'api/Publicacao/' + this.response.data[i].urlMidia + `" class="card-img-top sh-35" alt="card image" />
                                                    </a>
                                                    <div class="card-body">
                                                            <p class="text-alternate clamp-line mb-0" data-line="2">
                                                                ` + this.response.data[i].descricao + `
                                                            </p>
                                                    </div>
                                            </div>
                                        `;

                            document.getElementById("listaPublicacao").innerHTML += html

                            var html2 = `
                                        <div id="publicacaoAmpliada` + this.response.data[i].id + `" style="margin-top:5vh">
                                            <div style="width:100%; display: flex; justify-content: center;">
                                                <img style="height:70vh" src="` + RotaAPI + 'api/Publicacao/' + this.response.data[i].urlMidia + `" />
                                            </div>

                                            <div style="width:100%; display: flex; justify-content: center;">
                                                <p class="text-alternate clamp-line mb-0" data-line="2">
                                                    ` + this.response.data[i].descricao + `
                                                </p>
                                            </div>

                                            <hr style="width:100%; margin-top:3vh"/>

                                        </div>
                                `;

                            document.getElementById("framePublicacaoAmpliada").innerHTML += html2
                        }

                    }
                }
            };

            ajax.send();
        }

        function GetGaleriaPrestador() {
            const ajax = new XMLHttpRequest();
            ajax.open('GET', RotaAPI + 'api/Galeria?idUsuario=' + @Model);
            ajax.responseType = 'json';
            ajax.onload = function (e) {
                if (this.status == 200) {

                    console.log(this.response)

                    if (this.response.data != null) {

                        for (let i = 0; i < this.response.data.length; i = i + 1) {

                            var html = `
                                                <div id="galeria` + this.response.data[i].id + `" class="col">
                                                    <div class="card sh-35 hover-img-scale-up hover-reveal">
                                                        <img data-bs-toggle="modal" data-bs-target="#exampleModalFullscreen" src="` + RotaAPI + 'api/Galeria/' + this.response.data[i].urlMidia + `" class="card-img h-100 scale" alt="card image" />
                                                    </div>
                                                </div>
                                            `;

                            document.getElementById("listaGaleria").innerHTML += html

                            var html2 = `
                                                <div id="galeriaAmpliada` + this.response.data[i].id + `" style="margin-top:5vh">
                                                    <div style="width:100%; display: flex; justify-content: center;">
                                                        <img style="height:70vh" src="` + RotaAPI + 'api/Galeria/' + this.response.data[i].urlMidia + `" />
                                                    </div>

                                                    <hr style="width:100%; margin-top:3vh"/>

                                                </div>
                                        `;

                            document.getElementById("frameImagemAmpliada").innerHTML += html2
                        }

                    }
                }
            };

            ajax.send();
          }

    </script>

</body>
</html>
